<div class="min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 relative">
  <!-- Subtle Background Pattern -->
  <div class="absolute inset-0 opacity-5">
    <div class="w-full h-full bg-[radial-gradient(circle_at_1px_1px,rgba(255,255,255,0.15)_1px,transparent_0)] bg-[length:20px_20px]"></div>
  </div>
  
  <div class="relative z-10 max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4 lg:py-8">
    <!-- Header -->
    <header class="backdrop-blur-xl bg-white/10 border border-white/20 rounded-2xl p-4 lg:p-8 mb-4 lg:mb-8 shadow-2xl">
      <div class="flex items-center justify-between">
        <div>
          <h1 class="text-5xl font-bold text-white mb-3 flex items-center">
            <mat-icon class="text-5xl mr-3 text-yellow-400 drop-shadow-lg">wb_sunny</mat-icon>
            Weather AI Chat
          </h1>
          <p class="text-slate-300 text-lg">Intelligent weather insights powered by AI</p>
        </div>
        <div class="flex items-center space-x-4">
          <!-- Session Info -->
          <div *ngIf="currentSession" class="bg-white/10 backdrop-blur-sm rounded-lg px-6 py-3 border border-white/20 min-w-80 max-w-96 hidden lg:block">
            <div class="text-sm text-white flex items-center">
              {{getFirstUserMessage(currentSession)}}
              <mat-icon class="text-slate-300 ml-2 text-base">chat</mat-icon>
            </div>
          </div>
        </div>
      </div>
    </header>

    <section class="grid grid-cols-1 lg:grid-cols-4 gap-8">
      <!-- Chat Interface -->
      <div class="lg:col-span-3">
        <div class="backdrop-blur-xl bg-white/5 border border-white/10 rounded-2xl h-full flex flex-col shadow-2xl">
          <!-- Messages Container -->
          <div #chatContainer class="flex-1 overflow-y-auto p-6 space-y-6" [ngClass]="{'bg-gradient-to-br from-slate-800/20 to-purple-800/20': messages.length === 0}">
            <!-- Empty State -->
            <div *ngIf="displayedMessages.length === 0" class="flex items-center justify-center h-full">
              <div class="text-center">
                <div class="relative mb-8">
                  <mat-icon class="text-8xl text-yellow-400 drop-shadow-2xl">wb_sunny</mat-icon>
                  <div class="absolute inset-0 bg-yellow-400/20 rounded-full blur-3xl"></div>
                </div>
                <h3 class="text-2xl font-bold text-white mb-4">Welcome to Weather AI!</h3>
                <p class="text-slate-300 text-lg mb-8">Get intelligent weather insights powered by AI</p>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 max-w-2xl mx-auto">
                  <div 
                    class="bg-white/5 backdrop-blur-sm rounded-xl p-4 border border-white/10 cursor-pointer hover:bg-white/10 hover:border-white/20 transition-all duration-200"
                    (click)="useExamplePrompt('What\'s the weather like in London?')"
                  >
                    <p class="text-slate-300 text-sm">"What's the weather like in London?"</p>
                  </div>
                  <div 
                    class="bg-white/5 backdrop-blur-sm rounded-xl p-4 border border-white/10 cursor-pointer hover:bg-white/10 hover:border-white/20 transition-all duration-200"
                    (click)="useExamplePrompt('Will it rain tomorrow in Tokyo?')"
                  >
                    <p class="text-slate-300 text-sm">"Will it rain tomorrow in Tokyo?"</p>
                  </div>
                  <div 
                    class="bg-white/5 backdrop-blur-sm rounded-xl p-4 border border-white/10 cursor-pointer hover:bg-white/10 hover:border-white/20 transition-all duration-200"
                    (click)="useExamplePrompt('Should I bring an umbrella to New York?')"
                  >
                    <p class="text-slate-300 text-sm">"Should I bring an umbrella to New York?"</p>
                  </div>
                  <div 
                    class="bg-white/5 backdrop-blur-sm rounded-xl p-4 border border-white/10 cursor-pointer hover:bg-white/10 hover:border-white/20 transition-all duration-200"
                    (click)="useExamplePrompt('What\'s the forecast for Paris this weekend?')"
                  >
                    <p class="text-slate-300 text-sm">"What's the forecast for Paris this weekend?"</p>
                  </div>
                </div>
              </div>
            </div>

            <!-- Messages -->
            <app-chat-message
              *ngFor="let message of displayedMessages; let i = index"
              [message]="message"
              [typewriterActive]="typewriterActive"
              [isLastMessage]="i === displayedMessages.length - 1"
              (skipTypewriter)="skipTypewriter()"
            ></app-chat-message>

            <!-- Loading Indicator -->
            <div *ngIf="loading" class="flex items-start space-x-4">
              <!-- Avatar -->
              <div class="flex-shrink-0 w-12 h-12 rounded-full bg-gradient-to-br from-purple-500 to-blue-500 flex items-center justify-center shadow-lg">
                <mat-icon class="text-xl text-white">smart_toy</mat-icon>
              </div>
              
              <!-- Loading Content -->
              <div class="bg-white/10 backdrop-blur-sm p-4 rounded-xl border border-white/20">
                <div class="flex items-center space-x-3">
                  <div class="animate-spin rounded-full h-5 w-5 border-2 border-white/30 border-t-white"></div>
                  <span class="text-slate-300 font-medium">AI is thinking...</span>
                </div>
              </div>
            </div>
          </div>

          <!-- Input Area -->
          <app-chat-input
            [loading]="loading"
            (sendMessage)="sendMessage($event)"
            #chatInput
          ></app-chat-input>
        </div>
      </div>

      <!-- Sessions Sidebar -->
      <div class="lg:col-span-1">
        <!-- Session Controls -->
        <div class="backdrop-blur-xl bg-white/5 border border-white/10 rounded-2xl p-4 mb-4 shadow-2xl hidden lg:block">
          <div class="flex flex-col gap-3">
            
            <div class="flex items-center justify-between w-full">
              <span class="text-sm text-white">View Chat Sessions?</span>
              <div class="flex ml-2">
                <button 
                  [class]="showSessionList ? 'text-white' : 'bg-white/10 text-slate-300'"
                  [style.background-color]="showSessionList ? '#3f51b5' : ''"
                  (click)="showSessionList = true; toggleValue = 'yes'"
                  class="px-3 py-1 text-xs rounded-l-md border border-white/20 hover:bg-white/20 transition-colors"
                >
                  Yes
                </button>
                <button 
                  [class]="!showSessionList ? 'text-white' : 'bg-white/10 text-slate-300'"
                  [style.background-color]="!showSessionList ? '#3f51b5' : ''"
                  (click)="showSessionList = false; toggleValue = 'no'"
                  class="px-3 py-1 text-xs rounded-r-md border border-white/20 border-l-0 hover:bg-white/20 transition-colors"
                >
                  No
                </button>
              </div>
            </div>
            <button 
              mat-raised-button 
              color="primary"
              (click)="createNewSession()"
              class="text-sm px-4 py-2"
            >
              New Chat
            </button>
          </div>
        </div>
        
        <!-- Sessions List -->
        <div class="backdrop-blur-xl bg-white/5 border border-white/10 rounded-2xl shadow-2xl hidden lg:block" *ngIf="showSessionList">
          <app-session-list
            [sessions]="sessions"
            [currentSession]="currentSession"
            (sessionSelected)="loadSession($event)"
            (sessionDeleted)="deleteSession($event)"
            (cleanupRequested)="cleanupSessions()"
            (clearAllRequested)="clearAllSessions()"
          ></app-session-list>
        </div>
      </div>
    </section>

  </div>
</div>